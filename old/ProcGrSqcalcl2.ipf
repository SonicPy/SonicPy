#pragma rtGlobals=1		// Use modern global access method.Function grsqcalcl2()variable rmax=12,qmin=1.1,qmax=14,ndensity=0.11,rmin=1.3Prompt rmin, "Enter rmin: ";Prompt rmax, "Enter rmax: ";Prompt qmin, "Enter Qmin: ";Prompt qmax, "Enter Qmax: ";Prompt ndensity, "Enter number density: "DoPrompt "Enter rmin, rmax, Qmin, Qmax, number density", rmin,rmax,qmin,qmax,ndensityduplicate sq sq2,qiq;duplicate qa qa2make/N=(rmax*100+1)/D gr qiq=qa2*(sq2-1)*sin(pi*qa2/qmax)*(qmax/(pi*qa2))variable rfor(r=0;r<(rmax*100+1);r+=1)Duplicate qiq  qiqsinqrqiqsinqr=qiq*sin(qa2*r*0.01)Integrate/METH=1 qiqsinqr/X=qa/D=qiq_INTgr[r]=2/pi*qiq_INT[(qmax-qmin)*100]Killwaves qiqsinqr,qiq_INTendformake/N=(rmax*100+1)/D ravariable ifor(i=0;i<(rmax*100+1);i+=1)ra[i]=i*0.01endfordisplay gr vs raduplicate gr gr2;duplicate ra ra2variable r2for(r2=0;r2<(rmin*100+1);r2+=1)gr2[r2]=-4*pi*r2*0.01*ndensityendformake/N=(qmax*100+1)/D sqifftvariable qfor(q=qmin*100;q<(qmax*100+1);q+=1)Duplicate gr2 grsinqrgrsinqr=gr2*sin(ra2*q*0.01)Integrate/METH=1 grsinqr/X=ra/D=gr_INTsqifft[q]=1+1/(q*0.01)*gr_INT[(rmax*100+1)]Killwaves grsinqr,gr_INTendformake/N=(qmax*100+1)/D qaifftvariable i2for(i2=qmin*100;i2<(qmax*100+1);i2+=1)qaifft[i2]=i2*0.01endforDeletePoints 0,qmin*100, sqifft,qaifftdisplay sqifft vs qaifftduplicate sqifft sqifftl,qiqifftl;duplicate qaifft qaifftlmake/N=(rmax*100+1)/D grifftlqiqifftl=qaifftl*(sqifftl-1)variable r3for(r3=0;r3<(rmax*100+1);r3+=1)Duplicate qiqifftl qiqsinqrl;qiqsinqrl=qiqifftl*sin(qaifftl*r3*0.01);Integrate/METH=1 qiqsinqrl/X=qaifft/D=qiql_INT;grifftl[r3]=2/pi*qiql_INT[(qmax-qmin)*100];Killwaves qiqsinqrl,qiql_INTendformake/N=(rmax*100+1)/D raifftlvariable i3for(i3=0;i3<(rmax*100+1);i3+=1)raifftl[i3]=i3*0.01endfordisplay grifftl vs raifftlEnd